\documentclass[extra]{gji}
%\documentclass[extra, referee]{gji}

\usepackage[utf8]{inputenc}
\usepackage{timet}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{todonotes} % to make annotations on margins

\usepackage{url}
\usepackage[pdftex,colorlinks=true]{hyperref}
\hypersetup{
    allcolors=blue,
}


\begin{document}

\title[
    Variable Density Tesseroids]
    {Variable Density Tesseroids: Gravity fields calculation in spherical coordinates using variable densities in depth
}
\author[S.R. Soler, L. Uieda and M.E. Gimenez]
    {Santiado R. Soler$^{1,2}$, Leonardo Uieda$^3$ and Mario E. Gimenez$^{1,2}$ \\
    $^1$CONICET, Argentina. e-mail: santiago.r.soler@gmail.com\\
    $^2$Instituto Geofísico Sismológico Volponi, Universidad Nacional de San Juan, Argentina\\
    $^3$Universidade do Estado do Rio de Janeiro, Rio de Janeiro, Brazil
    }


\maketitle

\begin{summary}
Summary of this paper 
\end{summary}

\begin{keywords}
up to six keywords from the list
\end{keywords}



\section{Introduction}

Lithosphere density variation with depth has been studied for almost a century. 
\citet{Athy1930} obtained a decreasing exponential relation between both quantities by studying shale samples.
And, in the following years, other density functions have been proposed for different rock types \citep[e.g.][]{Maxant1980, Rao1986, Rao1993, Rao1994}.
Furthermore, the density variation with depth has been taken into account in forward and inversion gravity models, mostly applied to grabens and basins \citep{Cordell1973, Rao1986, Cowie1990, Rao1993, Rao1994, Welford2010}.

These forward gravity models have been developed for two or three dimensional bodies in cartesian coordinates that properly fit local scales applications.
Nevertheless, the latest satellite missions have provided us gravity measurements with global coverage, which allows geologists and geophysics to perform modelling and interpretation in regional scales.
This raises the importance of building forward models that reassemble the gravity anomalies for such scales. The main issue that should be overcome is that the curvature of the Earth must be taken into account, thus the modelling must be done in spherical coordinates.
One way to achieve this is to discretize the Earth in spherical prisms known as tesseroids. \todo{Insertar figura de tesseroides de leo}
Given an arbitrary tesseroid, calculating the gravity fields on any external point involves the resolution of volume elliptic integrals \todo{citar} that are generally approximated by numerical computations.
The literature offers two approaches: one involves Taylor series expansion \todo{citar} while the other makes use of Gauss-Legendre Quadrature (GLQ) \todo{citar}. The later consists in approximating the integral by a weighted sum of the effect of point masses located at scaled nodes of the Legendre polynomials.

In order to develop a forward model that computes the gravity field generated by any tesseroid with arbitrary variable density, the Taylor series expansion is not well suited, because it would need to derive the series expansion terms for each density function. On the other hand, the GLQ allows us to calculate them for any density function.

\citet{Uieda2016} developed a forward gravity model based on tesseroids with constant densities using the GLQ approximation method.
The GLQ method becomes less accurate when the computation point is closer to the tesseroid \todo{citar} and the smaller GLQ degree. 
Although the model developed by \citet{Uieda2016} uses a second GLQ degree, it ensures the accuracy implementing a modified version of the adaptative discretization of \citet{Li2011}.
It consist in splitting the tesseroid into smaller ones when a certain distance-size ratio ($D$) is greater than a predefined value that controls the precision of the computation. % that has been objectively obtained by \citet{Uieda2016} comparing the analytical and the numerically approximated gravity fields generated by a spherical shell.
The modifications made by \citet{Uieda2016} to the original adaptative discretization method \citep{Li2011} consist in:
(1) a faster calculation of the distance from the computation point to the tesseroid and 
(2) the application of a stack based algorithm instead of recursive function calls that  speeds up the algorithm and gives more control over the recursion step.
This forward gravity model has been originally implemented in command line programs written in C programming language. Although, it has been ultimately ported to Python and included in the open-source library Fatiando a Terra \todo{citar a fatiando} for geophysical modelling and inversion.

We have enhanced the later implementation with a new forward gravity model that allows us to compute the gravity fields generated by any tesseroid with an arbitrary density function on any external point.
It's written in Python and Cython languages, obtaining an easy to use library that runs precompiled code for the more time consuming functions.

It also makes use of some previously existing classes and functions from Fatiando a Terra, what saved us time and allowed us to focus on the new enhancements. Furthermore, we have the intention to include this new method into a future release of the Fatiando a Terra library in order to make its distribution and maintenance easier.

In order to ensure the accuracy of the numerical approximation, we have compared its results with a spherical shell with linear and exponential density functions, similar to the test performed by \cite{Uieda2016}. Although in this case, the analytical expressions for both density functions had to be derived.

In the following sections we will describe how the new algorithm works, its theoretical background and obtain the distance-size ratio values needed to get a good accuracy in the computation.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Acknowledgments}

We are indebted to the developers and maintainers of the open-source
software without which this work would not have been possible.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{gji}
\bibliography{bibtex/references}

\end{document}
