# Gravity fields calculation in spherical coordinates using Tesseroids with variable density

by
Santiago R. Soler,
Agustina Pesce,
Leonardo Uieda,
Mario E. Gimenez

This paper has been submitted for publication in *Some Journal*.

Brief description of what this paper is about (2-3 sentences). Include a figure
as well with the main result of your paper.

![Figure goes here.](https://raw.githubusercontent.com/pinga-lab/PAPER-REPO/master/FIGURE_FILE)
Brief figure caption.


## Abstract

Paste here the abstract.


## Reproducing the results

You can download a copy of all the files in this repository by cloning the
[git](https://git-scm.com/) repository:

    git clone https://github.com/pinga-lab/tesseroid-variable-density.git

or [click here to download a zip archive](https://github.com/pinga-lab/tesseroid-variable-density/archive/master.zip).

All source code used to generate the results and figures in the paper are in
the `code` folder. There you can find the Python and Cython codes that
performs the gravity field calculations and Jupyter notebooks that tests
those codes.

In `data` you can find the precalculated results of the notebooks,
so you can remake the plots under `manuscript/figures` without the need to rerun the
time consuming cells that generates those results.

The sources for the manuscript text and figures are in `manuscript`.

See the `README.md` files in each directory for a full description.

The calculations and figure generation are all run inside
[Jupyter notebooks](http://jupyter.org/).
You can view a static (non-executable) version of the notebooks in the
[nbviewer]() webservice:

http://nbviewer.jupyter.org/github/pinga-lab/PAPER-REPO

Also provided are read-only PDF versions of the notebooks.

See sections below for instructions on executing the code.


### Setting up your environment

You'll need a working Python **2.7** environment with all the standard
scientific packages installed (numpy, scipy, matplotlib, etc).  The easiest
(and recommended) way to get this is to download and install the
[Anaconda Python distribution](http://continuum.io/downloads#all).
Make sure you get the **Python 2.7** version.

#### Manual installation

You'll also need to install version 0.5 of the
[Fatiando a Terra](http://www.fatiando.org/) library.
See the install instructions on the website.

Other dependencies needed to reproduce the results are:
    * cython
    * basemap
    * sympy

You can install it through the conda package manager (included in Anaconda):
    ```
    conda install cython basemap sympy
    ```

#### Installing through conda environment

Instead of manually install all the dependencies, they can all be automatically
installed using a conda environment.

1. Change directory to the cloned git repository:
    ```
    cd tesseroid-variable-density
    ```
1. Create a new conda environment from the environment.yml file:
    ```
    conda env create -f environment.yml
    ```
1. Activate the new enviroment:
    * Windows: `activate tesseroid-variable-density`
    * Linux and MacOS: `source activate tesseroid-variable-density`

For more information about managing conda environments visit this
[User Guide](https://conda.io/docs/user-guide/tasks/manage-environments.html)

#### Compiling Cython code

The code that calculates the gravity fields generated by tesseroids with
variable density can be found in code/tesseroid-density. Because it's written
in Cython, you must compile it in order to call its functions. You can do it
with make command:

```
cd tesseroid-variable-density/code/tesseroid_density
make
```

> **Windows users:** It is highly recommended that you install the bash shell
> to run code and produce the results here.
> You can download bash for Windows at http://git-for-windows.github.io/.
> Install the "Git for Windows SDK" that will come with bash and `make` as
> well.

### Running the code

To execute the code in the Jupyter notebooks, you must first start the
notebook server by going into the repository folder and running:

```
jupyter notebook
```

This will start the server and open your default web browser to the Jupyter
interface. In the page, go into the `code` folder and select the
notebook that you wish to view/run.

The notebook is divided in cells (some have text while other have code).
Each cell can be executed using `Shift + Enter`.
Executing text cells does nothing and executing code cells runs the code
and produces it's output.
To execute the whole notebook, run all cells in order.


## License

All source code is made available under a BSD 3-clause license.  You can freely
use and modify the code, without warranty, so long as you provide attribution
to the authors.  See `LICENSE.md` for the full license text.

The manuscript text is not open source. The authors reserve the rights to the
article content, which is currently submitted for publication in the
JOURNAL NAME.
