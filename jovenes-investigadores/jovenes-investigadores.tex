\documentclass[a4paper,10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}
\usepackage[hmargin=2.5cm, vmargin=2.5cm]{geometry}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{subcaption} % enables subfigure
\usepackage{natbib}
\usepackage{url}
\usepackage[pdftex,colorlinks=true]{hyperref}
\hypersetup{
    allcolors=black,
}
\usepackage{mathptmx} %Times font


\title{
    \textbf{
    TESSEROIDES CON DENSIDADES VARIABLES:
    CÁLCULO DE CAMPOS GRAVITATORIOS EN COORDENADAS ESFÉRICAS CON
    DENSIDADES VARIABLES EN PROFUNDIDAD
    }
}
\author{
    Santiago R. Soler$^{1,2}$ \vspace{0.5em} \\ 
    \textit{$^1$ Instituto Geofísico Sismológico Volponi, Universidad Nacional de San Juan} \\
    \textit{$^2$ Consejo Nacional de Investigaciones Científicas y Técnicas (CONICET)} \vspace{0.4em} \\
    email: santiago.r.soler@gmail.com
}
\date{}


\begin{document}

\renewcommand{\tablename}{Tabla}

\maketitle

\vspace{-2.5em}
\begin{center}
\textbf{Palabras Clave:} poner algo
\end{center}
\vspace{0.5em}

\begin{abstract}
El cálculo directo de campos gravitatorios para grandes extensiones requiere tomar en cuenta la curvatura de la Tierra, lo cual suele resolverse a través del uso de prismas esféricos llamados Tesseroides. Además, estructuras como cuencas sedimentarias presentan variaciones de densidad con la profundidad.

\end{abstract}


\section{Introducción}

Las variaciones de la densidad en la corteza con la profundidad han sido estudiadas por casi un siglo: se propusieron diferentes tipos de variaciones con la profundidad \citep{Athy1930, Maxant1980, Rao1986, Rao1993, Rao1994} e incluso se han tenido en cuenta en modelos directos y de inversión gravimétrica, principalmente aplicados en cuencas y fosas \citep{Cordell1973, Rao1986, Cowie1990, Rao1993, Rao1994, Zhang2001, Welford2010}.

Estos modelos directos fueron desarrollados para cuerpos bidimensionales o tridimensionales en coordenadas cartesianas, los cuales se ajustan adecuadamente para aplicaciones de escalas locales.
Sin embargo, la disponibilidad de datos gravimétricos satelitales permite llevar a cabo estudios e interpretaciones a escalas regionales, en las cuales es necesario tomar en cuenta la curvatura de la Tierra a la hora de realizar modelados directos. 


\begin{figure}
    \begin{subfigure}[t]{0.5\textwidth}
    \centering
    \includegraphics[height=15em]{../manuscript/figures/tesseroid-uieda.pdf}
    \caption{
        Prisma esférico, también conocido como Tesseroid, en un sistema geocéntrico de coordenadas esféricas, junto a un punto de cómputo $P$ y su respectivo sistema de coordenadas Cartesiano local orientado hacia el Norte. Imágen producida por \citet{Uieda2015}.
    }
    \label{fig:tesseroid-uieda}
    \end{subfigure}
    \quad
    \begin{subfigure}[t]{0.5\textwidth}
    \centering
    \includegraphics[height=15em]{../manuscript/figures/spherical-shell.pdf}
    \caption{
        Cascarón esférico con radios interior y exteior $R_1$ y $R_2$, respectivamente. El punto de cómputo $Q$ está localizado en el eje $z$ a una distancia $r$ al centro del cascarón. Vamos a suponer que $Q$ se encuentra por fuera del radio exterior $R_2$, es decir $r > R_2$.
    }
    \label{fig:spherical-shell}
    \end{subfigure}
    \caption{}
\end{figure}

Un método muy común para hacerlo es discretizar la Tierra en prismas esféricos conocidos como Tesseroids (ver Figura \ref{fig:tesseroid-uieda}).
El cómputo de campos gravitatorios generados por un tesseroid arbitrario en un punto externo al mismo involucra la resolución de integrales volumétricas.
En caso de que el tesseroid posea una densidad variable, las ecuaciones obtenidas por \citet{Grombein2013} \citep[ver también][]{Uieda2016} para el cómputo de los campos gravitatorios se ven ligeramente modificadas. Por ejemplo, el potencial generado por un tesseroid arbitrario con densidad $\rho(r')$ sobre un punto de cómputo $P(r, \phi, \lambda)$ se puede obtener como:

\begin{equation}
    V(r,\phi,\lambda) = G 
    \int\limits_{\lambda_1}^{\lambda_2}
    \int\limits_{\phi_1}^{\phi_2}
    \int\limits_{r_1}^{r_2}
    \frac{\rho(r')}{\sqrt{{r'}^2 + r^2 - 2 r' r \cos \psi}} \, 
    r'^2 \cos \phi  dr' d\phi' d\lambda',
\label{eq:tesseroid-pot}
\end{equation}
\noindent donde
\begin{equation}
    \cos\psi = \sin\phi\sin\phi' + \cos\phi\cos\phi'
                 \cos(\lambda' - \lambda).
\label{eq:cospsi}
\end{equation}

Este tipos de integrales son generalmente aproximadas por cálculos numéricos.
Para el caso de densidades variables hemos concluido que uno de los métodos que mejor se adecúa para hacerlo es el que involucra la utilización de la Cuadratura de Gauss Legendre (GLQ) \citep{Asgharzadeh2007, Uieda2016, Uieda2017}.
El mismo consiste en aproximar las integrales por una suma ponderada de los efectos de masas puntuales localizadas en los ceros (previamente rescaldados) de los polinomios de Legendre.

\begin{equation}
    \iiint\limits_\Omega \rho(r') g(r', \phi', \lambda') d\Omega \approx
    A 
    \sum\limits_{i=1}^{N^r}
    \sum\limits_{j=1}^{N^\phi}
    \sum\limits_{k=1}^{N^\lambda}
    W_i^r W_j^\phi W_k^\lambda \rho(r_i) g(r_i, \phi_j, \lambda_k),
\label{eq:glq-var-dens}
\end{equation}
\noindent donde
\begin{equation}
    g(r', \phi', \lambda') =
    \frac{r'^2 \cos \phi}{\sqrt{{r'}^2 + r^2 - 2 r' r \cos \psi}},
    \quad
    W_i = \frac{2}{(1-x_i^2)[P_N^\prime(x_i)]^2},
    \quad
    A = \frac{(\lambda_2 - \lambda_1)(\phi_2 - \phi_1)(r_2 - r_1)}{8},
\end{equation}

\noindent $P_N$ es el polinomio de Legendre de orden $N$, $x_i$ sus ceros y $N^i$ con $i \in \{ r, \phi, \lambda\}$ los órdenes de las aproximaciones GLQ.

\citet{Uieda2016} desarrolló un modelo directo que permite calcular los campos gravitatorios generados por tesseroides con densidad homogenea utilzando las GLQ, implementado en Python e incluido en la librería de código abierto Fatiando a Terra \citep{Uieda2013} para el modelado e inversión geofísica.

\citet{Ku1977} advirtió que la aproximación GLQ se vuelve menos precisa a medida que el punto de cómputo se acerca al tesseroide o bien para órdenes menores de GLQ.
En vez de aumentar los órdenes de la aproximación, \citet{Uieda2016} lo fijan a segundo orden y aumentan la precisión a través de una versión modificada del algoritmo de discretización adaptativa de \citet{Li2011}.
Este consiste en dividir al tesseroide en otros más pequeños en caso de que el cociente entre $d$ y $L_i$ es menor a un valor predefinido $D$ llamado relación distancia-tamaño, donde $d$ es la distancia entre el punto de cómputo y el centro del tesseroide, mientras $L_i$ son las dimensiones del mismo ($i \in \{ r, \phi, \lambda\}$).

De esta manera, el valor asignado a $D$ controla la precisión de la aproximación: para mayores valores de $D$, el error de la aproximación se reduce.
Sin embargo, no existe una relación directa entre $D$ y dicho error.
Es por ello que \citet{Uieda2016} obtuvo valores estándar de $D$ comparando los campos gravitatorios generados por un cascarón esférico con densidad constante, un caso especial de las integrales volumétricas que posee solución analítica \citep{LaFehr1991, Mikuska2006, Grombein2013}.

En este trabajo hemos implementado un modelo directo como el de \citet{Uieda2016} que además permite calcular los campos gravitatorios generados por tesseroides con densidades variables arbitrarias en profundidad.
Al igual que el anterior, hace uso de la aproximación GLQ, de la versión modificada del algoritmo de discretización adaptativa y su implementación está escrita en lenguajes Python y Cython.

Para garantizar la precisión de la aproximación numérica, hemos llevado a cabo pruebas similares a las que realizaron \citet{Uieda2016} comparando los resultados del modelo numérico con las soluciones analíticas de un cascarón esférico, en nuestro caso con densidades lineales, exponenciales y discontinuas.
Para lo cual fue necesario obtener las soluciones analíticas correspondientes a cada función de densidad.


\section{Determinación de Relación Distancia-Tamaño}

Con el objetivo de evaluar el nuevo modelo directo con tesseroides de densidad variable y estimar el error de la aproximación hemos comparado el modelo numérico con las soluciones analíticas de un cascarón esférico para tres casos especiales: una densidad linear, una exponencial y una discontinua.

La estimación del error nos es útil para la determinación del mínimo valor de relación distancia-tamaño $D$ de manera tal que la diferencia entre el modelo numérico y las soluciones analíticas estén debajo de un umbral aceptable.

El cascarón esférico ha sido aproximado a través de una malla de tesseroides de $30^\circ \times 30^\circ$ y hemos calculado el potencial gravitatorio, la componente vertical del gradiente $g_z$ y la componente diagonal del tensor de Marussi $g_{zz}$ que la malla genera sobre cuatro grillas: (1) una localizada en el polo, (2) otra en el Ecuador, (3) una localizada a altura satelital y (4) una gran grilla de $30^\circ \times 30^\circ$.
En la Tabla \ref{tab:grids} podemos obtener más información acerca de estas grillas.

El cómputo de estos 

We computed the three gravity fields  on every point of these four grids for different values of $D$, ranging from 0.5 to 10 with a step of 0.5.
Then we calculated the maximum difference between these results and the value of the analytical solution at the same height.

Because the gravity fields generated by a tesseroid are approximated by the effect of point masses, the numerical results may vary between computation points at same height but at different latitude or longitude.
That's why we choose for comparison the maximum difference between the results on every point of the grid and the analytical solution.

Finally, we set the acceptable value of $D$ if the corresponding error of the numerical approximation is lower than 0.1\%.

\begin{table}
\centering
\caption{
    Descripciones de las grillas sintéticas en las cuales la comparación entre el modelo numérico y las soluciones analíticas se lleva a cabo. Esta colección de grilla intenta incluir todo posible escenario en el cual el modelo numérico pueda presentar diferentes comportamientos, dependiendo del tamaño de la grilla, su ubicación o su altura sobre la superficie de la Tierra. Cada grilla consiste en un conjunto de 10$\times$10 puntos.
}
\label{tab:grids}
\begin{tabular}{lcccc}
    Grid & Size & Lat. extension & Lon. extension & Height \\ \hline
    Pole & $1^\circ \times 1^\circ$ & $89^\circ - 90^\circ$ & $0^\circ - 1^\circ$ & 2km \\
    Equator & $1^\circ \times 1^\circ$ & $0^\circ - 1^\circ$ & $0^\circ - 1^\circ$ & 2km \\
    Satellite & $1^\circ \times 1^\circ$ & $89^\circ - 90^\circ$ & $0^\circ - 1^\circ$ & 260km \\
    Big Grid & $30^\circ \times 30^\circ$ & $60^\circ - 90^\circ$ & $0^\circ - 30^\circ$ & 2km \\
\end{tabular}
\end{table}



\begin{figure}
    \begin{subfigure}[t]{0.5\textwidth}
    \centering
    \includegraphics[height=30em]{../manuscript/figures/Dlinear-thin-differences.pdf}
    \caption{}
    \label{fig:D-linear-thin}
    \end{subfigure}
    \quad
    \begin{subfigure}[t]{0.5\textwidth}
    \centering
    \includegraphics[height=30em]{../manuscript/figures/Dexp-shifted-thin-differences.pdf}
    \caption{}
    \label{fig:D-exp-thin}
    \end{subfigure}
    \caption{
        Diferencias entre los campos gravitatorios generados por el modelo numérico y la solución analítica para un cascarón esférico de 1km de grosor con (a) densidad lineal definida en la ecuación \ref{eq:density-linear} y (b) densidad exponencial definida en la ecuación \ref{eq:density-exp}. Los computos fueron realizados en las cuatro grillas descriptas en la Tabla \ref{tab:grids} y para diferentes valores de la relación distancia-tamaño $D$. Si la diferencia es menor a 0.1\% consideraremos que el modelo ha alcanzado una precisión aceptable para el valor correspondiente de $D$.
    }
\end{figure}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Ejemplo con datos reales}


\begin{figure}
\centering
\includegraphics[width=\linewidth]{../manuscript/figures/neuquen-basin.pdf}
\caption{(a) Topography of Neuqu\'en Basin (in km),
         (b) Thickness of the sedimentary basin (in meters),
         (c)-(h) Computed gravity fields: potential $V$ (in J/kg), gradient components $g_x$, $g_y$ and $g_z$ (in mGal) and Marussi tensor components $g_{xy}$ and $g_{zz}$ (in Eötvös), calculated at 50km of height over the ellipsoid.}
\label{fig:neuquen-basin}
\end{figure}



\bibliographystyle{apalike-es}
\bibliography{../manuscript/bibtex/references}

\end{document}
